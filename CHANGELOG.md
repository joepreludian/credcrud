# Arquivo de Changelog
ℹ️ Esse arquivo visa funcionar como um log de decisões e ações que irei anotando enquanto vou implementando o projeto.

| ID | DATA/Hora     | Registro                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|----|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 8  | 25-nov 3h00p  | Acredito ter finalizado a camada de Schemas. Temos Card, CardPayload e RedactedCardPayload. Padronizei os métodos de Entrada, processamento e saída dos Cards, assim como coloquei algumas contraints ao Cadastrar um Card Novo. Por exemplo, durante o processo de criação do cartão eu já validarei se temos um cartão dentro do vencimento, assim como o processamento da data para o formato do tipo `datetime.date`. criei métodos auxiliares para retornar a representação no formato correto assim como a tratativa do serviço ficou bem simplificada. Agora Trabalharei na camada mais externa (service -> API Endpoint), tratando as chamadas como não autenticadas, depois adicionando a camada de autenticação, que deixarei simples pra não somar mais complexidade ao foco do problema de Dominio que eu quero resolver. Também vale ressaltar que eu adicionei na camada do pre-commit alguns utilitários, como `fix-eof`, pra garantir que o arquivo tenha uma nova linha, `bandit` para me assegurar que tenho um código livre de [CVE](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures) [Ok, é uma primeira barreira de segurança, mas certamente teríamos mais outras checagens por outras ferramentas dentro de um ambiente DEVOps (que eu poderia explicar como faria, já que trabalhei com DevOps no passado), `black` para formatação opiniosa de código python, `isort` para organizar as dependencias seguindo a PEP-0008, `autoflake` que me ajuda no processo de limpeza do código, removendo aqueles imports não utilizados, por exemplo e, por fim `flake8` que dá a verificação final se o codebase está PEP8 compliant. |
| 7  | 24-nov 11h45p | Depois de um dia de trabalho, o que foi feito? Trabalhei no restante dos métodos do repository, depois concluí o processo de manipulação dos Cards por meio dos Schemas. Nele eu conseguirei fazer o tratamento dos dados corretamente. Também implementei builders para construir modelos de banco de dados a partir do schema, ou um schema a partir de um banco de dados, ou um schema a partir de uma request. Com isso eu consigo centralizar todas as validações nesse modelo do pydantic de modo que fique fácil a manipulação de dados, servindo como um one stop shop para os dados. Para a camada de serviço, eu vou unir o repositório com os itens do schema para que eu apresentá-los ao usuário. Também adicionei um "to_representation()" no schema, que me retorna um CardPayload object, onde eu posso mascarar o dados do cartão, assim como trazer informações sobre a brand do mesmo, sem perder informação, muito menos mostrar informações sensíveis. A ideia é que o usuário possa ver os números de cartão de maneira a evitar dados sensíveis, logo mostro apenas os quatro últimos números. Para amanhã colocarei os endpoints e trabalharei no processo de autorização. Por fim, adicionarei o motor de criptografia. Também deixei o repositório com um belo pre-commit para fazer analises antes de mandá-las pelo git. (usarei-a também no futuro para a pipeline de CI)                                                                                                                                                                                                                                                                   |
| 6  | 24-nov 12h20a | Comecei a pensar em uma forma inteligente de salvar os dados e persistí-los no banco. O SQLAlchemy precisa ter acesso a um Declarative Base no projeto e também uma Engine e Session que se conecta ao banco de fato. Recriei os modelos mockados para que possamos testar as aplicações usando a mesma base de dados. Ao tentar ganhar tempo com o SQLITE para os testes, acabou que não ia dar certo já que ele não possui alguns campos que seriam utilizados dentro do modelo para Postgres. No caso criei um fixture a nível de projeto que vai instanciar a base de dados ao passo que vai me permitir trabalhar normalmente com o Repositório de Card. A logica será: um Model Card que interage com o Card Repository (que cuidará apenas da persistencia dos dados); um CardService que fará a ponte entre o dado ingerido do Pydantic model e fará a tradução tanto para o Repositório, quanto a visualização do dado para a camada externa, que seria a camada do REST. Será necesse momento que eu farei a manipulação da criptografia (ainda não implementada) e a apresentação tanto montando o dado para a visualização quanto preparando o dado para armazenamento.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 5  | 23-nov 6h38p  | Nesse caso estou desenvolvendo uma suite de testes mockando a base de dados em um database de teste para que eu possa executar os testes em cima do SQLAlchemy em uma base de dados desacoplada do código principal. O que eu vou fazer agor é justamente me  assegurar que os dados serão persistidos em uma base provisória e que ao término da execução dos meus testes ele elimine a base de dados, garantindo assim a resiliência do processo. Ainda estou conectando as pontas, uma vez que a criação da base real passa pela utilização do Alembic, mas a geração das bases de dados para teste vêm direto pelo SQLAlchemy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 4  | 23-nov 11h43a | Vale informar que eu não estou preocupado com o processo de autorização e autenticação, uma vez que precisaremos criar toda uma série de parametros, configurações e testes. Irei focar no mínimo necessário para proteger a API, mas caso façam questão eu posso desenvolver melhor, usando JWT, Oauth, ou até mesmo um provedor de serviço externo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 3  | 23-nov 11h30a | Agora vou declarar os modelos base, tanto do pydantic quanto no SQLALchemy. O workflow será o seguinte: irei tratar o Card pelo Pydantic Model, e na hora de persistir o SQLAlchemy servirá apenas como storage. Por ora isso será suficiente. Não estou preocupado em criptografar nada, apesar de já possuir uma estratégia pra isso. Irei criar um serviço de criptografia usando RSA. Para atender o requisito eu irei apenas colocar uma única chave privada criada e armazenada localmente para o processo de criptografia.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 2  | 22-nov 10h37p | Nesse caso minha approach será: 1) trabalhar primeiro no Alembic, uma vez que nunca trabalhei com ele [apesar de conhecer sua utilidade], depois farei o app `card` se comunicar com o banco de dados. Todos os comentários dentro do escopo do app eu tentarei fazê-lo em ingles caso seja necessário.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
| 1  | 22-nov 10h35p | A ideia desse projeto é tentar deixar o mais leve possível. Infelizmente um microframework requer muito trabalho adicional, e isso acaba tomando tempo. Percebi que a library de cartões provido como requisito técnico nesse projeto, faz com que eu precise adicionar o GIT enquanto dependencia. O ideal seria hospedá-lo no GIT. Até propus no repositório do projeto para criar uma pipeline para regularizar isso.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
